# 接口文档

更新日期：2023 年 6 月 7 日

## 统一返回格式

```json
{
  "code": 200,
  "msg": "success example",
  "data": "something..."
}
```

即每个数据包必是一个 JSON，固定带有 `code`，`msg` 和 `data` 三个字段。三个字段的语义可自行设计。目前仅当 `code` 为 `200` 时表示业务成功，其它均为业务失败。`msg` 通常展示错误时的提示信息，业务成功时可留空。`data` 用于存放欲返回的数据或详细的错误信息。

## 接口介绍

### `getAllPapers`

获取所有试卷。

调用方法：`GET`

| 参数    | 注释                                 |
| ------- | ------------------------------------ |
| `skip`  | 自然数。跳过前几项，`0` 表示不跳过。 |
| `limit` | 自然数。只获取几项。`0` 表示不限。   |

上述参数均是传给 `MongoDB` 使用的，语义一致。

返回值：只含有一个键 `papers`，其值为数组，每个元素为一张试卷，包含它在数据库中的 `_id` 和名字。

```json
{
  "papers": [
    {
      "_id": "xxx...",
      "name": "yyy..."
    }
  ]
}
```

### `getAllQuestionsByPaper`

获取某试卷的所有问题及可选的答案。

调用方法：`GET`

| 参数          | 注释                   |
| ------------- | ---------------------- |
| `paper_id`    | 试卷的 `_id`           |
| `need_answer` | 布尔值。是否需要答案。 |

返回值：只含有一个键 `questions`，其值为数组，每个元素为一个问题，包含题号、题面、选项。若要求答案，则一并提供。

```json
{
  "questions": [
    {
      "number": 1,
      "question": "问题",
      "choice": {
        "A": "选项A",
        "B": "选项B",
        "C": "选项C",
        "D": "选项D"
      },
      "answer": "A"
    },
    {
      "number": 2,
      "question": "问题2",
      "choice": {
        "A": "选项A",
        "B": "选项B",
        "C": "选项C",
        "D": "选项D"
      },
      "answer": "A"
    }
  ]
}
```

### `testPaper`

开始测试某试卷。

调用方法：`GET`

| 参数       | 注释         |
| ---------- | ------------ |
| `paper_id` | 试卷的 `_id` |

返回值：如同不带答案的 `getAllQuestionsByPaper`。

### `markAnswer`

作答某题。

调用方法：`GET`

| 参数     | 注释                 |
| -------- | -------------------- |
| `number` | 正整数。题号。       |
| `answer` | 字符串。作答的答案。 |

无返回值。

### `submit`

提交测试。

调用方法：`GET`

无参数。

返回值：作答得分。

```json
{
  "score": 1
}
```

### `getTest`

重新获取测试信息

调用方法：`GET`

无参数。

返回值：`answer` 表示已作答的题目和答案，`start` 表示开始测试的时间，`questions` 为问题集，`paper_name` 为试卷名称。

```json
{
  "answers": {
    "2": "A"
  },
  "start": "2023-06-07T02:02:15.601Z",
  "questions": [
    {
      "number": 1,
      "question": "问题",
      "choice": {
        "A": "选项A",
        "B": "选项B",
        "C": "选项C",
        "D": "选项D"
      }
    },
    {
      "number": 2,
      "question": "问题2",
      "choice": {
        "A": "选项A",
        "B": "选项B",
        "C": "选项C",
        "D": "选项D"
      }
    }
  ],
  "paper_name": "2022年国家公务员考试行测试卷（副省级）"
}
```
